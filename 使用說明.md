# 🔧 Miki Word 文件格式化工具 - 非技術人員使用指南

## 📋 工具功能
這個工具可以自動為 Word 文件中的表格添加總計行，支援批量處理多個文件，**同時生成 Word 和 PDF 兩種格式的輸出文件**。

## 🚀 最簡單的使用方法

### 方法一：使用圖形界面（推薦）
1. **點擊 `MikiFormatter.exe`** 文件
2. 等待圖形界面載入
3. 點擊「📄 選擇單個 Word 文件」或「📁 選擇整個資料夾」
4. 選擇你要處理的文件或資料夾
5. 點擊「🚀 開始處理」按鈕
6. 等待處理完成

### 方法二：拖放處理 (沒有圖形界面)
1. **將 Word 文件或資料夾直接拖放到 `拖放處理.bat` 文件上**
2. 系統會自動開始處理
3. 等待處理完成

## 📁 處理結果
- 原始文件**不會被修改**
- 處理後會生成**兩種格式的文件**：
  - **Word 文件**：儲存在 `success_docx` 資料夾中
  - **PDF 文件**：儲存在 `success_pdf` 資料夾中
- 處理後的文件保持原始檔名（不加前綴）
- 總計行會以**黃色背景**突出顯示

## 🎯 使用示例

### 示例 1：處理單個文件
```
原始文件: C:\Documents\報告.docx
處理結果: 
├── C:\Documents\success_docx\報告.docx  (Word 格式)
└── C:\Documents\success_pdf\報告.pdf   (PDF 格式)
```

### 示例 2：處理整個資料夾
```
原始資料夾: C:\Reports\
處理結果: 
├── C:\Reports\success_docx\
│   ├── 報告1.docx
│   ├── 報告2.docx
│   └── 報告3.docx
└── C:\Reports\success_pdf\
    ├── 報告1.pdf
    ├── 報告2.pdf
    └── 報告3.pdf
```

## ⚠️ 注意事項
1. **確保 Word 文件沒有被其他程式開啟**
2. 處理大量文件時請耐心等待（PDF 轉換需要額外時間）
3. 如果出現錯誤，請檢查：
   - 文件是否為 .docx 格式
   - 文件是否損壞
   - 電腦是否有足夠空間（需要存放兩種格式）
   - 是否已安裝 Microsoft Word（PDF 轉換需要）

## 🔧 系統需求
- Windows 作業系統
- Microsoft Word（用於 PDF 轉換）
- Python (工具會自動檢查和安裝)
- 足夠的磁碟空間（需存放兩種格式文件）

## 🆘 常見問題

### Q: 雙擊 .bat 文件沒有反應？



A: 請確保：
- 文件沒有被防毒軟體阻擋
- 系統允許執行批處理文件
- 右鍵點擊文件，選擇「以系統管理員身分執行」

### Q: 提示找不到 Python？
A: 工具需要 Python 環境，請：
1. 聯繫 IT 部門安裝 Python
2. 或下載 Python 並安裝（勾選「Add to PATH」選項）

### Q: 處理失敗了怎麼辦？
A: 請檢查：
- 文件格式是否正確（必須是 .docx）
- 文件是否包含目標表格（包含 Package、Service、Type 等欄位）
- 文件是否被其他程式開啟
- Microsoft Word 是否已正確安裝（PDF 轉換需要）

### Q: 只想要 Word 文件，不要 PDF 怎麼辦？
A: 工具會同時生成兩種格式，你可以：
- 只使用 `success_docx` 資料夾中的 Word 文件
- 刪除 `success_pdf` 資料夾中的 PDF 文件

### Q: PDF 轉換失敗了，但 Word 文件成功了？
A: 這是正常的，可能原因：
- Microsoft Word 未安裝或版本不相容
- Word 文件包含不支援的元素
- 可以手動開啟 Word 文件另存為 PDF

### Q: 可以同時處理多個資料夾嗎？
A: 目前一次只能處理一個文件或資料夾，但可以：
- 將所有文件放在同一個資料夾中批量處理
- 多次執行工具處理不同資料夾

### Q: 無法結束 MikiFormatter.exe？
A: 可以結束進程
```PowerShell
# PowerShell command
Stop-Process -Name "MikiFormatter" -Force
```

### Q: 批量處理時工具卡住或跑不動？
A: 這可能是以下原因造成的：
**常見原因**：
- 處理大量文件時記憶體不足
- Word COM 介面偶爾會卡住
- 某個文件有問題導致整個批次停止

**解決方法**：
1. **重新啟動工具**：關閉後重新開啟
2. **分批處理**：工具已自動分批處理（每批10個文件），但仍建議：
   - 超過50個文件時，分成多個資料夾處理
   - 每次處理完一批後重啟工具
3. **釋放記憶體**：
   - 關閉其他程式（瀏覽器、Office應用等）
   - 重新啟動電腦（最有效）
   - 檢查可用記憶體是否大於4GB
4. **檢查問題文件**：如果總是在某個文件卡住，可能該文件有問題
5. **使用進程管理**：
```PowerShell
# 結束所有相關進程
Stop-Process -Name "MikiFormatter" -Force
Stop-Process -Name "WINWORD" -Force
# 清理記憶體
[System.GC]::Collect()
```

**記憶體不足的徵象**：
- 處理速度越來越慢
- 電腦風扇聲音變大
- 其他程式反應遲緩
- 工具突然停止回應

**預防措施**：
- 建議單次處理不超過30個文件
- 處理大文件（>5MB）時減少批次大小
- 確保電腦有至少4GB可用記憶體
- 定期重啟工具（處理每50個文件後）


## 📞 技術支援
如果遇到問題：
1. 記錄錯誤訊息
2. 截圖保存錯誤畫面
3. 聯繫技術支援人員

---

💡 **小貼士**: 
- 建議先用少量文件測試，確認效果滿意後再批量處理
- Word 文件適合進一步編輯，PDF 文件適合最終分享和列印
- 黃色標記的總計行讓數據更加突出和專業
